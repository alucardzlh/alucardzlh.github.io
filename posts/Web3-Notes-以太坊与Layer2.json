{"__ud_title":"Web3 Notes 以太坊与Layer2","__ud_tags":[],"__ud_update_time":1745170413827,"__ud_create_time":1745170411959,"__ud_draft":true,"type":"doc","content":[{"type":"heading","attrs":{"level":1,"id":null},"content":[{"type":"text","text":"Web3 Notes 以太坊与Layer2"}]},{"type":"paragraph","content":[{"type":"text","text":"并不缺好的idea，但是赛道崛(链游、DeFi、NFT)以太交易严重拥堵高gas所以需要升级"}]},{"type":"paragraph","content":[{"type":"text","text":"Layer2就是通过协议把交易转到线下，线上同步结果"}]},{"type":"paragraph","content":[{"type":"text","text":"业界的认定Layer2必须继承Layer1的安全性"}]},{"type":"paragraph","content":[{"type":"text","text":"侧链不属于Layer2"}]},{"type":"paragraph","content":[{"type":"text","text":"策略应该独立运行，独立的共识协议"}]},{"type":"paragraph","content":[{"type":"text","text":"Rollups ：交易捆绑打包上传以太"}]},{"type":"paragraph","content":[{"type":"text","text":"Layer1：以太主链上发布的区块有gas Limit限制"}]},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"Rollups原理"}]},{"type":"paragraph","content":[{"type":"text","text":"1、在以太上部署智能合约记录状态，包括账户的状态交易的状态（默克尔树）"}]},{"type":"paragraph","content":[{"type":"text","text":"2、交易的计算在链下执行，交易计算会改变账户状态信息和State Root Hash，但是更新并不需要实时发布，而是交易数据+状态更新打包后发布以完成状态转移确认。大大提高效率"}]},{"type":"paragraph","content":[{"type":"text","text":"3、集成以太坊的安全性同时，把tps 从10几提高到成百上千。"}]},{"type":"paragraph","content":[{"type":"text","text":"4、交易放在CallData中，solidity中以CallData的形式传递的参数是不会被解析的，也不会被执行，可以理解成solidity只把它当成字节存储。"}]},{"type":"paragraph","content":[{"type":"text","text":"5、也有一种方案把大部分CallData放在链下，提高性能，但是牺牲安全性。"}]},{"type":"paragraph","content":[{"type":"text","text":"6、为了解决链下状态更新的安全性出现了OPTIMISTIC ROLLUPS  和ZK-ROLLUPS"}]},{"type":"paragraph","content":[{"type":"text","text":"OPTIMISTIC ROLLUPS：采用欺诈证明，缺省情况下假设ROLLUP对状态树根的更新是正确的。如果有人发现不对可发布证明上链，证明批次计算错误。而后智能合约验证状态更新确实存在错误就回滚。并且对提交欺诈者进行处罚。举报者进行奖励"}]},{"type":"paragraph","content":[{"type":"text","text":"OPTIMISTIC ROLLUPS："}]},{"type":"paragraph","content":[{"type":"text","text":"优点技术成熟，易于实现"}]},{"type":"paragraph","content":[{"type":"text","text":"缺点需要较长的退出挑战机制，挑战期长用户体验差 一般一至两周挑战期"}]},{"type":"paragraph","content":[{"type":"text","text":"要求社区里有猪狗多的挑战者来验证Rollup区块的合法性，并在挑战期前提交欺诈证明"}]},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"ZK-ROLLUPS：有效性证明。每个ROLLUPS提交时包含一个密码学证明。证明新状态根是执行状态交易后的结果，无论计算量多大都可以在链上快速验证。优势是安全性更高，劣势是所依赖的密码学证明很复杂。evm完全兼容不能"}]},{"type":"paragraph","content":[{"type":"text","text":"Layer2依赖Layer1工作"}]},{"type":"paragraph","content":[{"type":"text","text":"Optimism："}]},{"type":"paragraph","content":[{"type":"text","text":"乐观认为数据正确"}]},{"type":"paragraph","content":[{"type":"text","text":"引入争议事件延迟机制(Dispute Time Delay,DTD)"}]},{"type":"paragraph","content":[{"type":"text","text":"使用挑战期保护数据正确性 "}]},{"type":"paragraph","content":[{"type":"text","text":"为了防止ddos攻击，发起挑战也需要保证金"}]},{"type":"paragraph","content":[{"type":"text","text":"Arbitrum："}]},{"type":"paragraph","content":[{"type":"text","text":"L2 多轮交互式欺诈证明，和L1一步式证明"}]},{"type":"paragraph","content":[{"type":"text","text":"验证人和挑战者 在链下通过二分法不断拆分存在争议的步骤节点，直至最小化"}]},{"type":"paragraph","content":[{"type":"text","text":"再放到L1上验证，达到高效争端处理"}]},{"type":"paragraph","content":[{"type":"text","text":"缺点是：增加了交互次数 窗口交易期更长，需要原始提款人配合"}]},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"ZK-Rollup："}]},{"type":"paragraph","content":[{"type":"text","text":"利用零知识证明 保证交易有效性"}]},{"type":"paragraph","content":[{"type":"text","text":"安全依赖密码学原理，优点不存在挑战期"}]},{"type":"paragraph","content":[{"type":"text","text":"目前ZK通用计算能力较差，"}]},{"type":"paragraph","content":[{"type":"text","text":"与通用EVM兼容的扩容方案"}]},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"零知识证明："}]},{"type":"paragraph","content":[{"type":"text","text":"证明者向验证者  证明一个陈述是正确的，而无需透露除该陈述是正确的之外的其他信息"}]},{"type":"paragraph","content":[{"type":"text","text":"证明者需要运行在专门的设备上，去信任化的"}]},{"type":"paragraph","content":[{"type":"text","text":"证明者prover：负责计算交易并把这些交易聚合成零知识证明"}]},{"type":"paragraph","content":[{"type":"text","text":"验证者validator/verifier：验证证明者提交的零知识证明的有效性"}]},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"zk-snark:特殊零知识证明"}]},{"type":"paragraph","content":[{"type":"text","text":"非交互性，一次发送一个消息。简洁性，验证速度快存储空间小"}]},{"type":"paragraph","content":[{"type":"text","text":"证明者产生的工作量大，需要进行信任设置，随机元需要销毁"}]},{"type":"paragraph"},{"type":"paragraph"},{"type":"paragraph","content":[{"type":"text","text":"zk-sync：采用的是zk-snark"}]},{"type":"paragraph","content":[{"type":"text","text":"starkWare：zk-stark 是snark的升级：透明性（无需信任设置），扩展性（更快生成证明），抗量子攻击（ ）"}]}]}